<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Raspored Treninga i Praćenje</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 1em; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    button { padding: 0.5em 1em; margin-top: 1em; }
  </style>
</head>
<body>
  <h1>Tjedni raspored i praćenje ciljeva</h1>

  <table>
    <thead>
      <tr>
        <th>Dan</th>
        <th>Trening</th>
        <th>Prehrana / Post</th>
        <th>Odradio/la?</th>
      </tr>
    </thead>
    <tbody id="planTable">
      <!-- Redovi se dodaju dinamički -->
    </tbody>
  </table>

  <label for="selectedDate">Datum:</label>
  <input type="date" id="selectedDate">
  <button onclick="saveStatus()">Spremi status</button>
  <div id="status"></div>

  <script>
    const plan = [
      { dan: 'Ponedjeljak', trening: 'Snaga / HIIT', prehrana: 'Normalna prehrana' },
      { dan: 'Utorak', trening: 'Istezanje / Hodanje', prehrana: 'Post (1 obrok ili cijeli dan)' },
      { dan: 'Srijeda', trening: 'Snaga / HIIT', prehrana: 'Normalna prehrana' },
      { dan: 'Četvrtak', trening: 'Mobilnost / lagano', prehrana: 'Post (1 obrok)' },
      { dan: 'Petak', trening: 'Snaga / HIIT', prehrana: 'Normalna prehrana' },
      { dan: 'Subota', trening: 'Istezanje / Planinarenje', prehrana: 'Post (po mogućnosti)' },
      { dan: 'Nedjelja', trening: 'Snaga (bodyweight)', prehrana: 'Normalna prehrana' }
    ];

    const table = document.getElementById('planTable');
    plan.forEach((item, index) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${item.dan}</td>
        <td>${item.trening}</td>
        <td>${item.prehrana}</td>
        <td><input type="checkbox" id="done-${index}"></td>
      `;
      table.appendChild(row);
    });

    async function saveStatus() {
      const date = document.getElementById('selectedDate').value;
      if (!date) {
        alert('Molimo odaberite datum.');
        return;
      }

      const data = { datum: date, ciljevi: [] };
      plan.forEach((_, index) => {
        const isChecked = document.getElementById(`done-${index}`).checked;
        data.ciljevi.push({ red: index, status: isChecked });
      });

      document.getElementById('status').innerText = 'Spremam podatke...';
      const response = await fetch("https://script.google.com/macros/s/AKfycbxegGgWFhVnbtWd1csATVWek3fJRexPmiyZ6Wn65ZMjUXZvddZHOGoBOiglqUP5ujPZ/exec", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      });

      if (response.ok) {
        document.getElementById('status').innerText = 'Podaci spremljeni!';
      } else {
        document.getElementById('status').innerText = 'Greška pri spremanju podataka!';
      }
    }
  </script>
</body>
</html>
